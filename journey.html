<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="æ—…ç¨‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆã‚¢ãƒ—ãƒª">
    <title>æ—…ç¨‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« - GitHub Pages</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="title">ğŸ—ºï¸ æ—…ç¨‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h1>
            <p class="subtitle">ã‚ãªãŸã®æ—…ã®è¨ˆç”»ã‚’ä½œæˆãƒ»ç®¡ç†ã—ã¾ã—ã‚‡ã†</p>
        </header>

        <main class="main-content">
            <!-- ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ¥ãƒ¼ï¼šæ—…ç¨‹ä¸€è¦§ -->
            <div id="main-view">
                <section class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2>ğŸ“‹ æ—…ç¨‹ä¸€è¦§</h2>
                        <button class="btn" id="create-journey-btn">+ æ–°ã—ã„æ—…ç¨‹ã‚’ä½œæˆ</button>
                    </div>

                    <div id="journey-list" class="journey-list">
                        <p class="empty-state">ã¾ã æ—…ç¨‹ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br>ã€Œæ–°ã—ã„æ—…ç¨‹ã‚’ä½œæˆã€ãƒœã‚¿ãƒ³ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ï¼</p>
                    </div>
                </section>

                <section class="cta-section">
                    <h2>ğŸŒŸ æ—…ã®è¨ˆç”»ã‚’å§‹ã‚ã¾ã—ã‚‡ã†</h2>
                    <p>æ—…ç¨‹ã‚’ä½œæˆã—ã¦ã€æ™‚ç³»åˆ—ã§äºˆå®šã‚’ç®¡ç†ã§ãã¾ã™ã€‚éå»ã®æ—…è¡Œè¨˜éŒ²ã¨ã—ã¦ã‚‚æ´»ç”¨ã§ãã¾ã™ã€‚</p>
                    <a href="index.html" class="btn">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
                </section>
            </div>

            <!-- æ—…ç¨‹ä½œæˆãƒ»ç·¨é›†ãƒ“ãƒ¥ãƒ¼ -->
            <div id="create-view" style="display: none;">
                <section class="card">
                    <h2 id="form-title">âœï¸ æ—…ç¨‹ã‚’ä½œæˆ</h2>

                    <form id="journey-form">
                        <div class="form-group">
                            <label for="journey-title">æ—…ç¨‹ã‚¿ã‚¤ãƒˆãƒ« *</label>
                            <input type="text" id="journey-title" required placeholder="ä¾‹: äº¬éƒ½ãƒ»å¤§é˜ªæ—…è¡Œ">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="destination">ç›®çš„åœ° *</label>
                                <input type="text" id="destination" required placeholder="ä¾‹: äº¬éƒ½ãƒ»å¤§é˜ª">
                            </div>
                            <div class="form-group">
                                <label for="duration">æœŸé–“ *</label>
                                <input type="text" id="duration" required placeholder="ä¾‹: 3æ³Š4æ—¥">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="start-date">å‡ºç™ºæ—¥ *</label>
                            <input type="date" id="start-date" required>
                        </div>

                        <div class="form-group">
                            <label>æ—¥ç¨‹</label>
                            <div id="days-container"></div>
                            <button type="button" class="btn-secondary" id="add-day-btn">+ æ—¥ç¨‹ã‚’è¿½åŠ </button>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-secondary" id="cancel-btn">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                            <button type="submit" class="btn">ä¿å­˜ã™ã‚‹</button>
                        </div>
                    </form>
                </section>
            </div>

            <!-- æ—…ç¨‹è©³ç´°ãƒ“ãƒ¥ãƒ¼ -->
            <div id="detail-view" style="display: none;">
                <section class="card">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                        <div>
                            <h2 id="detail-title"></h2>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn-secondary" id="edit-btn">âœï¸ ç·¨é›†</button>
                            <button class="btn-danger" id="delete-btn">ğŸ—‘ï¸ å‰Šé™¤</button>
                        </div>
                    </div>

                    <div class="journey-overview" id="detail-overview"></div>
                </section>

                <div id="detail-days"></div>

                <section class="cta-section">
                    <button class="btn" id="back-to-list-btn">ä¸€è¦§ã«æˆ»ã‚‹</button>
                </section>
            </div>
        </main>

        <footer class="footer">
            <p>&copy; 2026 Claude Apps. GitHub Pagesã§å…¬é–‹ä¸­</p>
        </footer>
    </div>

    <script>
        // ãƒ‡ãƒ¼ã‚¿ç®¡ç†
        class JourneyManager {
            constructor() {
                this.journeys = this.loadJourneys();
                this.currentJourneyId = null;
                this.editingJourneyId = null;
            }

            loadJourneys() {
                const data = localStorage.getItem('journeys');
                return data ? JSON.parse(data) : [];
            }

            saveJourneys() {
                localStorage.setItem('journeys', JSON.stringify(this.journeys));
            }

            addJourney(journey) {
                journey.id = Date.now().toString();
                journey.createdAt = new Date().toISOString();
                this.journeys.unshift(journey);
                this.saveJourneys();
                return journey.id;
            }

            updateJourney(id, journey) {
                const index = this.journeys.findIndex(j => j.id === id);
                if (index !== -1) {
                    this.journeys[index] = { ...journey, id, createdAt: this.journeys[index].createdAt };
                    this.saveJourneys();
                }
            }

            deleteJourney(id) {
                this.journeys = this.journeys.filter(j => j.id !== id);
                this.saveJourneys();
            }

            getJourney(id) {
                return this.journeys.find(j => j.id === id);
            }
        }

        const manager = new JourneyManager();

        // ãƒ“ãƒ¥ãƒ¼ç®¡ç†
        const views = {
            main: document.getElementById('main-view'),
            create: document.getElementById('create-view'),
            detail: document.getElementById('detail-view')
        };

        function showView(viewName) {
            Object.values(views).forEach(view => view.style.display = 'none');
            views[viewName].style.display = 'block';
            window.scrollTo(0, 0);
        }

        // æ—…ç¨‹ä¸€è¦§ã®è¡¨ç¤º
        function renderJourneyList() {
            const listContainer = document.getElementById('journey-list');

            if (manager.journeys.length === 0) {
                listContainer.innerHTML = '<p class="empty-state">ã¾ã æ—…ç¨‹ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br>ã€Œæ–°ã—ã„æ—…ç¨‹ã‚’ä½œæˆã€ãƒœã‚¿ãƒ³ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ï¼</p>';
                return;
            }

            listContainer.innerHTML = manager.journeys.map(journey => `
                <div class="journey-card" data-id="${journey.id}">
                    <div class="journey-card-header">
                        <h3>${escapeHtml(journey.title)}</h3>
                        <span class="journey-date">${new Date(journey.startDate).toLocaleDateString('ja-JP')}</span>
                    </div>
                    <div class="journey-card-body">
                        <div class="journey-info">
                            <span>ğŸ“ ${escapeHtml(journey.destination)}</span>
                            <span>ğŸ“… ${escapeHtml(journey.duration)}</span>
                            <span>ğŸ“ ${journey.days.length}æ—¥åˆ†ã®äºˆå®š</span>
                        </div>
                    </div>
                </div>
            `).join('');

            // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            document.querySelectorAll('.journey-card').forEach(card => {
                card.addEventListener('click', () => {
                    const id = card.dataset.id;
                    showJourneyDetail(id);
                });
            });
        }

        // æ—…ç¨‹è©³ç´°ã®è¡¨ç¤º
        function showJourneyDetail(id) {
            const journey = manager.getJourney(id);
            if (!journey) return;

            manager.currentJourneyId = id;

            document.getElementById('detail-title').textContent = journey.title;
            document.getElementById('detail-overview').innerHTML = `
                <div class="overview-item">
                    <span class="overview-label">ç›®çš„åœ°ï¼š</span>
                    <span class="overview-value">${escapeHtml(journey.destination)}</span>
                </div>
                <div class="overview-item">
                    <span class="overview-label">æœŸé–“ï¼š</span>
                    <span class="overview-value">${escapeHtml(journey.duration)}</span>
                </div>
                <div class="overview-item">
                    <span class="overview-label">å‡ºç™ºæ—¥ï¼š</span>
                    <span class="overview-value">${new Date(journey.startDate).toLocaleDateString('ja-JP')}</span>
                </div>
            `;

            const daysHtml = journey.days.map((day, index) => `
                <section class="card journey-day">
                    <div class="day-header">
                        <h2>ğŸ“… ${index + 1}æ—¥ç›®${day.title ? ' - ' + escapeHtml(day.title) : ''}</h2>
                        <span class="day-date">${day.date || ''}</span>
                    </div>
                    <div class="timeline">
                        ${day.activities.map(activity => `
                            <div class="timeline-item">
                                <div class="timeline-marker"></div>
                                <div class="timeline-content">
                                    <div class="timeline-time">${escapeHtml(activity.time)}</div>
                                    <h3>${escapeHtml(activity.title)}</h3>
                                    ${activity.description ? `<p>${escapeHtml(activity.description)}</p>` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </section>
            `).join('');

            document.getElementById('detail-days').innerHTML = daysHtml;
            showView('detail');
        }

        // ãƒ•ã‚©ãƒ¼ãƒ ã®åˆæœŸåŒ–
        function initForm(journeyId = null) {
            const form = document.getElementById('journey-form');
            const daysContainer = document.getElementById('days-container');

            form.reset();
            daysContainer.innerHTML = '';
            manager.editingJourneyId = journeyId;

            if (journeyId) {
                const journey = manager.getJourney(journeyId);
                if (journey) {
                    document.getElementById('form-title').textContent = 'âœï¸ æ—…ç¨‹ã‚’ç·¨é›†';
                    document.getElementById('journey-title').value = journey.title;
                    document.getElementById('destination').value = journey.destination;
                    document.getElementById('duration').value = journey.duration;
                    document.getElementById('start-date').value = journey.startDate;

                    journey.days.forEach(day => addDayToForm(day));
                }
            } else {
                document.getElementById('form-title').textContent = 'âœï¸ æ—…ç¨‹ã‚’ä½œæˆ';
                addDayToForm(); // æœ€åˆã®1æ—¥ã‚’è¿½åŠ 
            }
        }

        let dayCounter = 0;

        function addDayToForm(dayData = null) {
            dayCounter++;
            const dayDiv = document.createElement('div');
            dayDiv.className = 'day-form';
            dayDiv.dataset.dayId = dayCounter;

            dayDiv.innerHTML = `
                <div class="day-form-header">
                    <h3>${dayCounter}æ—¥ç›®</h3>
                    <button type="button" class="btn-remove" onclick="removeDay(${dayCounter})">å‰Šé™¤</button>
                </div>
                <div class="form-group">
                    <label>æ—¥ä»˜ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆä»»æ„ï¼‰</label>
                    <input type="text" class="day-title" placeholder="ä¾‹: äº¬éƒ½åˆ°ç€" value="${dayData?.title || ''}">
                </div>
                <div class="form-group">
                    <label>æ—¥ä»˜ï¼ˆä»»æ„ï¼‰</label>
                    <input type="text" class="day-date" placeholder="ä¾‹: 3æœˆ15æ—¥ï¼ˆåœŸï¼‰" value="${dayData?.date || ''}">
                </div>
                <div class="activities-container" data-day="${dayCounter}">
                    ${dayData ? dayData.activities.map((activity, i) => createActivityHtml(dayCounter, i, activity)).join('') : createActivityHtml(dayCounter, 0)}
                </div>
                <button type="button" class="btn-secondary btn-sm" onclick="addActivity(${dayCounter})">+ äºˆå®šã‚’è¿½åŠ </button>
            `;

            document.getElementById('days-container').appendChild(dayDiv);
        }

        function createActivityHtml(dayId, activityId, data = null) {
            return `
                <div class="activity-form" data-activity-id="${activityId}">
                    <div class="form-row">
                        <div class="form-group" style="flex: 0 0 120px;">
                            <label>æ™‚åˆ» *</label>
                            <input type="text" class="activity-time" required placeholder="09:00" value="${data?.time || ''}">
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label>äºˆå®š *</label>
                            <input type="text" class="activity-title" required placeholder="ä¾‹: æ¸…æ°´å¯ºå‚æ‹" value="${data?.title || ''}">
                        </div>
                        <button type="button" class="btn-remove-activity" onclick="removeActivity(${dayId}, ${activityId})" title="å‰Šé™¤">Ã—</button>
                    </div>
                    <div class="form-group">
                        <label>è©³ç´°ï¼ˆä»»æ„ï¼‰</label>
                        <input type="text" class="activity-description" placeholder="ä¾‹: æ¸…æ°´ã®èˆå°ã¨å‘¨è¾ºæ•£ç­–" value="${data?.description || ''}">
                    </div>
                </div>
            `;
        }

        function addActivity(dayId) {
            const container = document.querySelector(`.activities-container[data-day="${dayId}"]`);
            const activities = container.querySelectorAll('.activity-form');
            const newId = activities.length;

            const div = document.createElement('div');
            div.innerHTML = createActivityHtml(dayId, newId);
            container.appendChild(div.firstElementChild);
        }

        function removeDay(dayId) {
            const dayForm = document.querySelector(`[data-day-id="${dayId}"]`);
            if (dayForm) {
                dayForm.remove();
                renumberDays();
            }
        }

        function removeActivity(dayId, activityId) {
            const activity = document.querySelector(`.activities-container[data-day="${dayId}"] .activity-form[data-activity-id="${activityId}"]`);
            if (activity) {
                const container = activity.parentElement;
                if (container.querySelectorAll('.activity-form').length > 1) {
                    activity.remove();
                } else {
                    alert('å„æ—¥ã«ã¯æœ€ä½1ã¤ã®äºˆå®šãŒå¿…è¦ã§ã™');
                }
            }
        }

        function renumberDays() {
            const days = document.querySelectorAll('.day-form');
            days.forEach((day, index) => {
                day.querySelector('h3').textContent = `${index + 1}æ—¥ç›®`;
            });
        }

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        document.getElementById('journey-form').addEventListener('submit', (e) => {
            e.preventDefault();

            const journey = {
                title: document.getElementById('journey-title').value,
                destination: document.getElementById('destination').value,
                duration: document.getElementById('duration').value,
                startDate: document.getElementById('start-date').value,
                days: []
            };

            document.querySelectorAll('.day-form').forEach(dayForm => {
                const day = {
                    title: dayForm.querySelector('.day-title').value,
                    date: dayForm.querySelector('.day-date').value,
                    activities: []
                };

                dayForm.querySelectorAll('.activity-form').forEach(activityForm => {
                    const activity = {
                        time: activityForm.querySelector('.activity-time').value,
                        title: activityForm.querySelector('.activity-title').value,
                        description: activityForm.querySelector('.activity-description').value
                    };
                    day.activities.push(activity);
                });

                journey.days.push(day);
            });

            if (manager.editingJourneyId) {
                manager.updateJourney(manager.editingJourneyId, journey);
            } else {
                manager.addJourney(journey);
            }

            renderJourneyList();
            showView('main');
        });

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('create-journey-btn').addEventListener('click', () => {
            initForm();
            showView('create');
        });

        document.getElementById('cancel-btn').addEventListener('click', () => {
            showView('main');
        });

        document.getElementById('add-day-btn').addEventListener('click', () => {
            addDayToForm();
        });

        document.getElementById('back-to-list-btn').addEventListener('click', () => {
            showView('main');
        });

        document.getElementById('edit-btn').addEventListener('click', () => {
            initForm(manager.currentJourneyId);
            showView('create');
        });

        document.getElementById('delete-btn').addEventListener('click', () => {
            if (confirm('ã“ã®æ—…ç¨‹ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                manager.deleteJourney(manager.currentJourneyId);
                renderJourneyList();
                showView('main');
            }
        });

        // ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // åˆæœŸåŒ–
        renderJourneyList();

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, { threshold: 0.1 });

        function observeCards() {
            document.querySelectorAll('.card, .cta-section').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(card);
            });
        }

        observeCards();
    </script>
</body>
</html>
